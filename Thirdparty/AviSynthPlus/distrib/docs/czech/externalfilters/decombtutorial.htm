<html>
<head>
<title>Decomb Plugin pro Avisynth 2.5</title>
<link rel="stylesheet" type="text/css" href="../../avisynth.css">
<!--
Automatically generated, don't change:
$Id: decombtutorial.htm,v 1.1 2010/02/27 14:50:14 wilbertd Exp $
-->
</head>

<body>
<h1 align=center>Decomb Plugin pro Avisynth<br>
(Verze 5.2.3)<br>
Tutorial</h1>

<h2 align=center>od Donald A. Graft</h2>
<p><hr><p>
<h2>Obsah</h2>

<ul>
 <li><a href="#introduction">Úvod</a></li>
 <li><a href="#telecide">Telecide()</a></li>
 <ul>
  <li><a href="#field order">Krok 1. Urèení a nastavení poøadí polí</a>
  <li><a href="#pattern">Krok 2. Nastavení øízení šablony (Pattern Guidance) pokud je to vhodné</a>
  <li><a href="#postprocessing">Krok 3. Nastavení postprocessingu</a>
 </ul>
 <li><a href="#decimate">Decimate()</a></li>
 <ul>
  <li><a href="#decimation">Krok 4. Nastavení decimace</a>
 </ul>
 <li><a href="#refinements">Doladìní</a></li>
</ul>

<p><hr size=2 width="100%" align=center>
<h2><a name=introduction>Úvod</a></h2>

<p>Tento dokument je tutorial pro Decomb. Nabízí kuchaøku procedur
pro správné použití Telecide() a Decimate() ke zpracování daného klipu. Nezahrnuje
FieldDeinterlace() protože je celkem jednoduché ho pochopit z pøíruèky Decomb.
<p>
Podívejte se prosím do
prùvodní pøíruèky Decomb na podrobný popis Decomb
a jeho parametrù.</p>
<p>
<hr size=2 width="100%" align=center>

<h2><a name=telecide>Telecide()</a></h2>

<p>Telecide() obnovuje
progresivní snímky (nalezením a uspoøádáním (spárováním) polí).
Nepoužívejte Telecide() na streamy, které neobsahují
progresivní snímky podrobené telecine, jako napø. prokládané video.</p>

<a name="field order"></a>
<h3>Krok 1. Urèení a nastavení poøadí polí</h3>
<p>Pro správné rendrování je zásadní správné nastavení poøadí polí. Poøadí polí je
získáno z Avisynthu a mùže být nastaveno funkcemi AssumeTFF() nebo AssumeBFF()
ve vašem skriptu pøed výzvou Telecide(). Nastavte AssumeTFF() pro horní pole první; použijte AssumeBFF()
pro spodní pole první (bottom field first). Protože správné nastavení je tak dùležité,
dùraznì se vám doporuèuje nedìlat domnìnky o poøadí polí v klipu, ale radìji si poøadí polí
ovìøit pomocí následující procedury.</p>
<p>
Pro urèení poøadí polí, vytvoøte skript Avisynthu, který pøedává syrový klip bez jakéhokoli
zpracování. Pokud to je AVI, tak prostì použijte AviSource(). Pro naše pøíklady budeme používat
AviSource(). Pøidejte skriptový øádek pro oddìlení polí s použitím horního pole jako prvního, jako zde:
<pre>AviSource(&quot;your_clip.avi&quot;)
AssumeTFF().SeparateFields()</pre>
<p>Nyní pøedejte skript do VirtualDubu a najdìte oblast s pohybem. Krokujte vpøed podle
pohybu. Všímejte si zda jde pohyb vždy vpøed jak by mìl jít, nebo zda skáèe
zpìt a vpøed. Napøíklad, pokud je poøadí polí nesprávné,
objekt pohybující se trvale zleva doprava by se pohnul doprava, pak by trochu skoèil zpìt doleva, pak
by se hnul zase doprava, atd. Pokud je poøadí polí správné, hýbe se trvale doprava.</P>
<p>Pokud je pohyb správný pøi AssumeTFF().SeparateFields(), pak je vaše poøadí polí s horními
poli prvními a musíte použít AssumeTFF(). Pokud není pohyb správný, pak je vaše poøadí polí se
spodními poli prvními a musíte použít AssumeBFF(). Pokud chcete dvojitou kontrolu, mùžete ještì použít
AssumeBFF.SeparateFields() pro kontrolu správné operace pro spodní pole první.</p>
<p>Pøedpokládejme, že v následujících krocích máme klip s horními poli prvními. Samozøejmì by jste použili
správné poøadí polí pro váš klip. Tedy, náš skript je následující:
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide()
</pre>

<h3><a name="pattern">Krok 2. Nastavení øízení šablony (Pattern Guidance) pokud je to vhodné</a></h3>
<p>Èasto víte z povahy klipu jaká šablona pro telecine (pokud je nìjaká) je použita a tedy jaká
by mìla být šablona pro uspoøádání polí. Funkce øízení šablony Telecide() používá takovou
informaci pro zlepšení uspoøádání polí. Øízení šablony je ovládáno volitelným parametrem
<i>guide</i>. Má 4 možné hodnoty: guide=0 znamená vypnuté øízení šablony;
guide=1 znamená použití 3:2 pulldown øízení (24fps->30fps); guide=2 znamená použití øízení 2:2 (PAL);
a guide=3 znamená použití øízení 3:2:3:2:2 (25fps->30fps).
<p>
Nejdøíve rozhodnìte, jestli je váš zdrojový klip PAL. Pokud je a pokud má progresivní obsah, mùžete
témìø vždy nastavit guide=2 pro použití øízení šablony PAL. Jistì pokud váš klip nemá progresivní
obsah, nepomùže vám to, a vùbec by jste nemìli použít Telecide() ! Tedy pro PAL,
mùžeme pøistoupit ke Kroku 3 se skriptem vypadajícím takto:
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide(guide=2)
</pre>

<p>
Pokud máme NTSC 29.97fps nebo 30fps zdrojový klip, práce bude ošidnìjší.
Nejdøíve musíme urèit zda klip obsahuje
3:2 pulldown materiál. Existuje nìkolik zkoušek, které mùžeme použít. Nejdøíve pøedejme syrový klip
(žádné zpracování v Decomb nebo jiné) do VirtualDubu. Pak krokujme po snímcích v pohybových pasážích.
Pokud vidíte opakující se šablonu 3 èistých snímkù následovaných 2 prokládanými snímky, tak je to 3:2 pulldown.
Obvykle budou filmy používat 3:2 pulldown.
<p>Hledání šablony 3:2 podle popisu výše, není zcela spolehlivé, protože u animací bývají
duplikované snímky, které mohou ztížit vidìt èistou šablonu 3:2.
<p>Za druhé, mùžete pøedávat do VirtualDubu následující skript a sledovat co o nìm Telecide() øíká
(pamatujte na použití správného poøadí polí, jak je popsáno výše).
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide(guide=1,post=0,show=true)
</pre>

Pøedávejte to do VirtualDubu a krokujte po nìkolika typických èástech vašeho klipu. Pokud Telecide() hlásí
"in-pattern", nebo "in-pattern*", pak je to uzamèeno do šablony 3:2 pulldown. Pokud hlásí "out-of-pattern"
nebo soustavnì skáèe do (in) a mimo (out) šablonu, pak to není uzamèeno do souvislé šablony 3:2.
<p>
Pokud urèíte, že váš klip má hodnì obsahu 3:2 , pak by jste mìli jít vpøed a nastavit guide=1.
Pokud nemá hodnì obsahu 3:2 , nebo máte jakékoliv pochybnosti o podstatì klipu, pak
by jste mìli nastavit guide=0. Budeme pøedpokládat, že máme hodnì obsahu 3:2 pro další kroky. Proto, náš
skript zatím vypadá takto:
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide(guide=1)
</pre>

<h3><a name="postprocessing">Krok 3. Nastavení postprocessingu</a></h3>
<p>Postprocessing je proces, kterým snímky vycházející z uspoøádání polí stále
roztøepené, mohou být detekovány a je v nich odstranìno prokládání. Režimy postprocessingu jsou øízeny parametrem
<i>post</i> : post=0 znamená vypnutý postprocessing; post=1 znamená výpoèet metrik, ale bez odstraòování prokládání;
post=2 znamená výpoèet metrik a jim odpovídající odstraòování prokládání; a post=3 znamená
znamená výpoèet metrik a jim odpovídající odstraòování prokládání a zobrazení pohybové mapy odstraòování prokládání
pro snímky které jsou detekovány jako roztøepené. Existují také dva pokroèilejší režimy; podívejte se prosím do
pøíruèky na více podrobností.
<p>
Použijeme standardní proceduru pro nastavení postprocessingu. Nejdøíve zapneme metriky
a zobrazíme je následovnì (všimnìte si, že sem pøenášíme døíve stanovená nastavení -- použili by jste
døíve urèené <i>order</i> a <i>guide</i>):
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide(guide=1,post=3,vthresh=25,show=true)
</pre>

Pøedávejte to VirtualDubu, pøehrávejte klip a testujte pøi tom snímky a zobrazované
hodnoty <i>vmetric</i> . Hodnota, která se použije na snímek jako uspoøádání je ta, která je v hranatých závorkách
a zaèíná "chosen=", napø., "[chosen=27]". Prostì vyvolejme hodnotu <i>vmetric</i> .
Každá hodnota <i>vmetric</i> vìtší než <i>vthresh</i>
definuje snímek jako prokládaný.
Chcete najít hodnotu <i>vthresh</i> , která správnì rozliší roztøepené snímky od neroztøepených snímkù
vašeho klipu. Snadno budete moci identifikovat snímky uvažované jako roztøepené protože a) hodnota <i>vmetric</i>
bude vìtší než <i>vthresh</i>, b) indikátor progresivnosti/prokládání øekne prokládaný, a c) snímek
bude pøekrytý bílou pohybovou mapou odstraòování prokládání. Není možnost, že by jste si jich nevšimli!
<p>
Vámi zvolený <i>vthresh</i> nemusí být dokonalý a pokud není, mìli by jste mít chybu na stranu bezpeènosti.
Je lepší zachytit i nìkteré progresivní snímky, než minout nìkteré roztøepené.
<p>
Pøedpokládejme, že naše hodnota <i>vthresh</i> , která rozlišuje roztøepené od neroztøepených snímkù je 30.
Nyní vytvoøte následující skript s post=2 (jako vždy, pøeneste vaše døíve stanovená nastavení):
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide(guide=1,post=2,vthresh=30,show=true)
</pre>

Pøedejte a pøehrávejte to ve VirtualDubu. Jak krokujete v klipu, mìli by jste vidìt progresivní snímky
ponechané bez zásahu a (døíve) roztøepené snímky s odstranìným prokládáním.
<p>
Pokud nejste spokojeni s odstranìním prokládání z roztøepených snímkù a chcete je "zpracovat trochu tvrdìji",
mùžete snížit paramet <i>dthresh</i> . Také, pokud upøednostòujete interpolaci pøed smícháním (blending) pro
roztøepené oblasti, mùžete zmìnit parametr <i>blend</i> . Podívejte se do pøíruèky na správné použití
tìchto parametrù.
<p>
Náš skript tedy zatím vypadá takto:
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide(guide=1,post=2,vthresh=30)
</pre>

<p>Existují ještì dvì dùležitìjší vìci o kterých si øekneme k postprocessingu pøed tím než pùjdeme dál. Za prvé, je
drobný rozdíl mezi post=2 a post=4 který vás mùže ovlivnit. Pøíruèka popisuje
rozdíly podrobnì. Nastavení post=2 èasto zabrání tvorbì hrubých smíchání snímkù pøi zmìnì scény, ale
mùže vytváøet trhavé video sekvence po odstranìní prokládání. Nastavení post=4 udrží plynulost sekvencí s
odstranìným prokládáním, ale mùže vytváøet smíchané snímky pøi zmìnì scény.</p>
<p>Za druhé, mùžete zjistit, že potøebujete rùzné hodnoty <i>vthresh</i> pro rùzné èásti vašeho klipu. Pokud je
to tak, použijte ruèní pøepsání (nadøazení) Telecide pro zadání hodnot pro rùzné rozsahy snímkù podle potøeby.
Na podrobnosti s podívejte do pøíruèky.
</p>
<h2><a name=decimate>Decimate()</a></h2>
<p>Jako postranní efekt provádìní uspoøádání polí pro 3:2 pulldown, Telecide() vysílá duplikované snímky a
ponechává klip s jeho pùvodní frekvencí snímkù. Decimate() detekuje a odstraòuje tyto duplikáty a nastavuje
frekvenci snímkù odpovídajícím zpùsobem níže.
<h3><a name="#decimation">Krok 4. Nastavení decimace</a></h3>
<p>Pokud je váš klip PAL, nevyžadujete decimaci a jste u konce!
<p>Pokud má váš klip 3:2 pulldown, budete potøebovat decimovat klip. Jednoduše pøidejte výzvu Decimate().
Váš koneèný skript pak bude vypadat jako tento:
<pre>
AviSource("your_clip.avi")
AssumeTFF()
Telecide(guide=1,post=2,vthresh=30)
Decimate()
</pre>

Jedna vìc, které by jste si mìli být vìdomi je, že nemùžete vždy chtít decimovat 30fps materiál. Napøíklad, pokud
je váš klip hybridem z 3:2 progresivního a normálního prokládaného videa, a pokud ho decimujete vytvoøíte
èásti videa trhavé. Èasto je u takových klipù lepší, nechat je s jejich pùvodní frekvencí snímkù
vynecháním Decimate().
<h2><a name="refinements">Doladìní</a></h2>
<p>Tento manuál byl napsán jen se základními parametry a procedurami vyžadovanými pro
rychlé zvládnutí Decomb. Existuje mnohem více parametrù, které mùžete použít na neobvyklé a obtížné
situace. Podívejte se prosím do pøíruèky Decomb pro zaèátek prùzkumu tìchto pøídavných
funkcí.
<p>Zde je jeden pøíklad doladìní, aby jste pochopili o èem zde mluvím: Dejme tomu, že máte
zašumìlou nahrávku a právì prožíváte selhávání uspoøádání polí. Mùžete pøidat nìjakou zvláštní
toleranci šumu do Telecide() zvýšením hodnoty parametru
<i>nt</i>. V pøíruèce najdete øadu takových malých perel.
Je velkou zásobárnou ètiva.
<p>
<hr size=2 width="100%" align=center>

<p>Copyright &copy; 2003-2008, Donald A. Graft, All Rights Reserved.</p>

<p>Pro aktualizace a jiné filtry/nástroje, navštivte mou webovou stránku:<br>
<a href="http://neuron2.net/" target="_top">http://neuron2.net/</a>
</p>

<p><kbd>$English Date: 2004/08/13 21:57:25 $</kbd></p>
<p><kbd>Èeský pøeklad:19.3.2009</kbd></p>
</body>

</html>
