<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="ru">
<head>
  <meta http-equiv="Content-Language" content="ru">
   <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<!--
Automatically generated, don't change:
$Id: importing_media.htm,v 1.6 2008/07/18 17:28:04 fizick Exp $
-->
   <title> Импорт медиа в AviSynth </title>
<style type=text/css></style>
   <link rel="stylesheet" type="text/css" href="../../avisynth.css">
</head>
<body>

<h1>Импорт медиа в Avisynth</h1>

<h2>Содержание</h2>
<a href="#load_clip">1) Загрузка клипов в AviSynth<br>
</a>&nbsp;&nbsp;&nbsp; <a href="#load_clip_vidaud">1.1) Загрузка клипов с видео и аудио в
AviSynth<br>
</a>&nbsp;&nbsp;&nbsp; <a href="#load_clip_vid">1.2) Загрузка видео клипов в
AviSynth<br>
</a>&nbsp;&nbsp;&nbsp; <a href="#load_clip_aud">1.3) Загрузка аудио клипов в
AviSynth<br>
</a>&nbsp;&nbsp;&nbsp; <a href="#load_image">1.4) Загрузка изображений в
AviSynth</a>
<p><a href="#merit_filter">2) Изменение приоритета DirectShow фильтров</a></p>
<p><a href="#graphs">3) Использование GraphEdit для создания графов DirectShow
фильтров и загрузка этих графов в AviSynth</a></p>

<h2><a name="load_clip"></a>Загрузка клипов в AviSynth</h2>
<p>Большинство видео/аудио форматы могут быть загружены в AviSynth,
но есть некоторые исключения как swf видео, flv4 (VP6) и dvr-ms.
Если невозможно загрузить клип в AviSynth,
вы должны преобразовать его в некоторый другой формат, который может быть загружен.
Помните выбрать формат, для которого вы будете иметь минимальную потерю
в качестве в результате преобразования.
<p>Вообще есть два способа загрузить ваше видео в AviSynth:
<ol>
  <li>используя AviSynth фильтр или плагин, который предназначен для открытия
некоторого специального формата.</li>
  <li>используя <a href="../corefilters/directshowsource.htm"> DirectShowSource</a> плагин.</li>
</ol>
<p>Удостоверьтесь, что ваш клип содержит максимум один видео и (или) один аудио поток
(таким образом удалите субтитры и удалите другие видео/аудио потоки).
Если вы хотите загрузить клип, который содержит видео и аудио,
у вас есть две возможности:
<ul>
  <li>Выделите (demux) аудио поток и загрузите потоки отдельно в AviSynth.</li>
  <li>Попробуйте загрузить клип в AviSynth целиком. Это может сработать или
может не сработать. Для AVI, удостоверьтесь, что вы имеете установленный
хороший AVI расщепитель
    [<a href="http://sourceforge.net/project/showfiles.php?group_id=82303">Gabest
    AVI splitter</a>]. (Да, Windows поставляется с собственным AVI расщепителем,
который будет работать в большинстве случаев.)</li>
</ul>
<p>При загрузке клипа в AviSynth советуем следовать следующим правилам:</p>
<ul>
  <li>Если возможно загрузить ваш клип в AviSynth, используя либо AviSource
 либо специальный плагин, то делайте так, так как это более надежно чем
 две альтернативы, которые приведены ниже.</li>
  <li>Если указанное выше не сработало, загрузите клип используя DirectShowSource плагин.</li>
  <li>Если указанное выше не сработало, преобразуйте ваш клип в другой формат
 (в такой, какой поддерживается AviSynth).</li>
</ul>
<p>Для многих форматов объясняется, как загрузить их в AviSynth, но если ваш
формат не обсуждается здесь, тут должно быть достаточно обсуждения, с чего вам надо начать.
<i>Часто существуют несколько способов загрузить ваш формат в
AviSynth, так что если один из них не работает, не забудьте попробовать
другие. Например, пусть вы получили AVI с 5.1 DTS,но он не открывается как 5.1 с
 AviSource. Попробуйте другие способы, такие как открытие с DirectShowSource
(используя AC3filter), или разделите видео и аудио и загрузите dts с NicAudio.</i></p>

<h3><a name="load_clip_vidaud"></a>1.1) Загрузка клипов с видео и аудио в AviSynth</h3>
<h4>1.1.1) AVI с аудио:</h4>
<p>Для загрузки AVI с аудио вам необходимыd
(1) VfW (<a href="http://en.wikipedia.org/wiki/Video_for_Windows">Video for
Windows</a>) кодек чтобы открыть (то есть декодировать) ваше видео в AviSynth
и ACM (<a href="http://en.wikipedia.org/wiki/Audio_Compression_Manager">Audio Compression
Manager</a>) кодек чтобы открыть ваше аудио в AviSynth.
Для многих видео и аудио форматов такие кодеки доступны, но точно не для всех.</p>
<p>Число различных видео форматов, которые могут быть найдены в AVI, достаточно
ограничено. Вот избранные из них:</p>
<ul>
  <li>MPEG-4 ASP (установите XviD или DivX для декодирования этого формата).</li>
  <li>MPEG-4 AVC (это чтобы быть более точным; закодированное видео,
 где подмножество свойств MPEG-4 AVC было использовано для его создания,
 может быть помещено в AVI; насколько я знаю, не существует специфичного
 x264 VfW декодера, так что вам необходимо открыть эти файлы с DirectShowSource).</li>
  <li> DV (установите <a href="http://www-user.rhrk.uni-kl.de/~dittrich/cedocida/index.html">Cedocida кодек</a>
    [<a href="http://forum.doom9.org/showthread.php?t=94458">ссылка на кодек</a>]).</li>
  <li>MJPEG: насколько я знаю не существует бесплатного VfW MJPEG декодера
 (однако ffdshow может декодировать это).</li>
  <li>WMV (установите <a href="http://nic.dnsalias.com/wm9enc.html">WM9/VC-1 кодеки</a>).</li>
  <li><a href="http://forum.doom9.org/showthread.php?t=97877">VP7</a>.</li>
</ul>
<p>Список аудио форматов дан ниже:</p>
<p><u>аудио: несжатый WAV, CBR/VBR MP2 или CBR/VBR MP3:</u></p>
<p>Существует ACM кодек для MP2 называемый
 [<a href="http://www.geocities.com/wilbertdijkhof/qmpeg_mp2.zip">QDesign</a>].
Существуют ACM кодеки для MP3
[<a href="http://www.free-codecs.com/MPEG_Layer_3_Codec_download.htm">Radium
Codec</a>] или [<a href="http://www.free-codecs.com/LAME_ACM_Codec_download.htm">Lame
ACM</a>].</p>
<p><u>аудио: AC3/DTS:</u></p>
<p>Существует ACM кодек для AC3 называемый
[<a href="http://fcchandler.home.comcast.net/AC3ACM/index.html">AC3ACM</a>].
Есть ACM кодек для AC3/DTS называемый valex ACM кодек
[<a href="http://sourceforge.net/project/showfiles.php?group_id=66022">vac3acm</a>].</p>
<p>Примеры:</p>
<pre>AviSource(&quot;d:\xvid_dts.avi&quot;)</pre>
<p>Возьмите AC3/DTS directshow фильтр подобно
<a href="http://sourceforge.net/project/showfiles.php?group_id=66022">AC3Flter</a>
 (удостоверьтесь, что микширование (downmixing) выключено,
если только вы не хотите, чтобы звук был смикширован или он является
стерео или моно) и
<a href="http://sourceforge.net/project/showfiles.php?group_id=82303"> AVI-AC3/DTS
 splitter</a>, или ffdshow (с DTS установленным в libdts).
Используйте AC3Filter и создайте скрипт:</p>
<pre>DirectShowSource(&quot;d:\xvid_dts.avi&quot;)</pre>
<p><u>аудио: AAC:</u></p>
<p>Для AAC не существует надежного ACM кодека, так что невозможно
загрузить ваш клип с AAC с AviSource. Возьмите AAC directshow фильтр подобный
CoreAAC (удостоверьтесь, что микширование выключено, если только вы не хотите
 микшировать) или ffdshow (с AAC установленным в libfaad2 или realaac).
Мы использовали <a href="http://sourceforge.net/project/showfiles.php?group_id=173941"> ffdshow</a>
здесь:</p>
<p><img border="0" src="../pictures/advancedtopics/ffdshow_avi_aac.jpg" width="575" height="465"></p>
<p>используйте скрипт</p>
<pre>DirectShowSource(&quot;d:\xvid_aac.avi&quot;)</pre>
<p>для загрузки вашего AVI.</p>

<h4><a name="cont_audio"></a>1.1.2) Другие контейнеры с аудио:</h4>
<p>Не всегда возможно загрузить ваши клипы в AviSynth используя AviSource (или
один из специальных плагинов, которые будут обсуждены ниже). Примерами
являются не-AVI, представляющие собой клипы, содержащиеся внутри другого
контейнера, такого как MKV, MP4, RMVB, OGM или ASF/WMV. В этом случае
DirectShowSource является вашей последней надеждой. Также вполне возможно,
что вы имеете AVI, с соответствующим установленным VfW кодеком,
но вы хотите использовать DirectShow кодек для открытия в AviSynth.
В этом случае вы также должны использовать DirectShowSource.</p>
<p>При проигрывании клипа в WMP6.4 (mplayer2.exe), для проигрывания используются
DirectShow фильтры (*.ax).
Они являются теми же самыми, которые &quot;используются&quot; DirectShowSource.
Так что вам надо удостовериться, что вы имеете установленными
соответствующие DirectShow фильтры.
Чтобы выяснить, какие фильтры используются при проигрывании клипа,
откройте клип в WMP6.4 и посмотрите в меню:
файл -&gt; свойства -&gt; Дополнительно. Здесь вы также можете изменить настройки
фильтров. Вы получите больше информации о фильтрах если вы откроете ваш клип
например в <a href="http://www.headbands.com/gspot/">GSpot</a>. Просто
откройте клип и нажмите &quot;1&quot; под A/V в "Proposed Codec Solutions and Tests" панели.
Конструируется &quot;graph&quot; с фильтрами, которые используются чтобы проиграть клип:</p>
<p><img border="0" src="../pictures/advancedtopics/directshow_avi_aac.jpg" width="864" height="638"></p>
<p>(Если вы удивлены, благодаря моим настройкам в AC3Filter, он всегда показывается
вверху в цепочке фильтров. Но в данном примере он не должен загрузиться,
так как он не поддерживает AAC.)</p>
<p>Если вы получили сообщение &quot;rendering failed (...)&quot;, это означает,
что требуемые DirectShow фильтры не установлены. Удостоверьтесь, что
файл проигрывается корректно путем нажатия &quot;2&quot; под &quot;1&quot;.
Потому что если он не играется, DirectShowSource не сможет загрузить клип.
Вообще говоря, вы можете столкнуться со следующей проблемой
с этим подходом: <b><i>другие DirectShow фильтры используются при проигрывании
медиа файла, а не те, которые вы установили или хотите использовать.
Это может случиться из-за того, что используемые фильтры имеют более
высокий приоритет (merit),  чем те, которые вы хотели бы использовать</i></b>.
Есть два решения этой проблемы:</p>
<ol>
  <li>изменить приоритет используемых фильтров используя
<a href="http://www.free-codecs.com/download/RadLight_Filter_Manager.htm">Radlight
    Filter Manager</a>.</li>
  <li>использовать <a href="http://forum.doom9.org/showthread.php?t=104234">GraphEdit
    (последнее сообщение в ветке)</a> чтобы построить граф, используя
 DirectShow фильтры по вашему выбору и загрузить данный граф с DirectShowSource.</li>
</ol>
<p>Это будет обсуждено в разделах
&quot;<a href="#merit_filter">Изменение приоритета DirectShow фильтров</a>&quot;
и &quot;<a href="#graphs">Использование GraphEdit для создания графов DirectShow
фильтров и загрузка этих графы в AviSynth</a>&quot;.</p>
<p>К счастью вы можете установить
<a href="http://sourceforge.net/project/showfiles.php?group_id=173941">ffdshow</a>
(который идет с несколькими DirectShow декодерами), который способен
декодировать многие форматы.
Например:</p>
<ul>
  <li>MPEG1/2: разрешите mpeg1/2 путем выбора libavcodec или libmpeg2 библиотеки:<br>
    <img border="0" src="../pictures/advancedtopics/ffdshow_m2p.jpg" width="604" height="507"></li>
  <li>MJPEG в AVI: разрешите mjpeg путем выбора библиотеки libavcodec.</li>
  <li>DV в AVI: разрешите DV путем выбора библиотеки libavcodec.</li>
  <li>MPEG-4 ASP в OGM: <font color="#FF0000">xxx</font></li>
  <li><font color="#FF0000">MKV / MP4 / TS</font></li>
  <li>h.264 в MKV/MP4: установите <font color="#FF0000">xxx</font> и используйте ffdshow</li>
  <li>h.264 в TS: установите Haali расщепитель и используйте ffdshow (или CoreAVC)</li>
  <li>h.263 в FLV1: возьмите
[<a href="http://sourceforge.net/project/showfiles.php?group_id=82303">flv splitter</a>]
и разрешите проигрывание h.263 путем выбора библиотеки libavcodec.</li>
</ul>
<p>Пример:</p>
<p>Загрузим MP4 (видео: h.264, аудио: aac) используя DirectShowSource и ffdshow
 (декодирование aac разрешено в ffdshow; если audio является
AC3 или DTS, вы можете также вместо этого использовать AC3Filter).
Ваш скрипт станет например таким:</p>
<pre>DirectShowSource(&quot;d:\x264_aac.mp4&quot;, fps=25, convertfps=true) # подстройте fps при необходимости</pre>
<p><u>некоторые другие форматы:</u></p>
<p>* RM/RMVB (RealMedia / RealMedia с переменным битрейтом; обычно содержит
Real Video/Audio): установите
<a href="http://sourceforge.net/projects/guliverkli/">rmvb splitter</a>
 и Real кодеки путем устанвки
RealPlayer/<a href="http://www.free-codecs.com/download/Real_Alternative.htm">RealAlternative</a>.
Создайте скрипт:</p>
<pre>DirectShowSource(&quot;d:\clip.rmvb&quot;, fps=25, convertfps=true) # подстройте fps при необходимости</pre>
<p>
* WMV/ASF (Windows Media Video / Advanced Systems Format; обычно содержит
WMV/WMA): этот формат не полностью поддерживается ffdshow,
так что вы должны будете установить wmv кодеки.
Возьмите <a href="http://msdn.microsoft.com/windowsmedia/downloads/default.aspx">
 WMF SDK v9 для W2K или позже для XP/Vista</a> который содержит кодеки
 (и DMO упаковщики (wrappers) необходимые для использования DMO фильтров
в DirectShow). (Заметьте, что собственный кодек Microsoft VC1 не поддерживается
в W2K так как вам необходим WMF SDK v11.) Создайте скрипт:</p>
<pre>DirectShowSource(&quot;d:\clip.wmv&quot;, fps=25, convertfps=true) # подстройте fps при необходимости</pre>
<h3><a name="load_clip_vid"></a>1.2) Загрузка видео клипов в AviSynth</h3>
<p>Как уже объяснялось, вообще есть два способа загрузить ваше видео в AviSynth:</p>
<ol>
  <li>используя AviSynth функцию или плагин, которые разработаны для открытия
некоторого специального формата.</li>
  <li>используя DirectShowSource.</li>
</ol>
<p>Список всех этих плагинов и принимаемых форматов дан ниже.</p>
<p><u>1) AviSynth фильтры и плагины, предназначенные для открытия специфических
форматов:</u></p>
<p><u>AviSource - AVI/VDR:</u></p>
<p><a href="../corefilters/avisource.htm">AviSource</a> поддерживает все виды
AVI (в том числе с MP3 (VBR MP3) или AC3 аудио). Он также поддерживает DV типа 1 и типа 2,
и фрейм-серверные файлы VirtualDub (VDR).</p>
<p>AVI может быть загружен в AviSynth при условии, что вы имеете
соответствующий установленный VfW кодек для декодирования данного формата AVI.
Кодек по умолчанию, используемый для декодирования AVI, указан в заголовке медиа
файла (в его заголовке) как FourCC (FOUR Character Code, четырех-символьный код).
Начиная с версии 2.55 в AVISource добавлена опция fourCC,
которая позволяет использовать другие кодеки для загрузки вашего
AVI.</p>
<p>Несколько примеров:</p>
<pre>AviSource(&quot;d:\filename.avi&quot;)</pre>
<p>или без audio:</p>
<pre>AviSource(&quot;d:\filename.avi&quot;, false)</pre>
<p>Явное указание декодера, который будет использован для загрузки клипа в AviSynth: </p>
<pre># load your avi using the XviD codec:
AviSource(&quot;d:\filename.avi&quot;, fourCC=&quot;XVID&quot;) # открывает avi (например DivX3) используя кодек XviD

# загружаем ваш dv-avi используя Canopus DV кодек:
AviSource(&quot;d:\filename.avi&quot;, fourCC=&quot;CDVC&quot;)

# vdr-файлы (файлы фреймсервера VirtualDub):
AviSource(&quot;d:\filename.vdr&quot;) </pre>
<p>Если AviSynth жалуется о невозможности загрузить ваш avi
<font color="#FF0000"> (couldn't decompress ...)</font>
вам необходимо установить соответствующий кодек.
Программа GSpot, например, скажет вам, какой кодек вам необходимо установить
для возможности проигрывать ваш avi.</p>

<p><u>Mpeg2Source/DGDecode - MPEG1/MPEG2/VOB/TS/PVA:</u></p>
<p>DGDecode (старая версия называлась Mpeg2Dec3) является вшеншим плагином
и поддерживает MPEG-1, MPEG-2 / VOB, TS и PVA потоки.
Откройте их сначала в DGIndex (или Dvd2avi 1.76/1.77.3 для Mpeg2Dec3)
и создайте d2v файл, который может быть открыт в AviSynth (заметьте,
что это будет открывать только видео в AviSynth):</p>
<p>Немного примеров:</p>
<pre># старый Mpeg2dec3; если вам необходим d2v файл, созданный с dvd2avi 1.76/1.77.3
LoadPlugin(&quot;d:\mpeg2dec3.dll&quot;)
mpeg2source(&quot;d:\filename.d2v&quot;)

# DGDecode:
LoadPlugin(&quot;d:\dgecode.dll&quot;)
mpeg2source(&quot;d:\filename.d2v&quot;) </pre>
<p>Заметьте, что Mpeg2Dec3 очень ограничен по сравнению с DGDecode, так как
это в сущности более старая версия той же программы,
развитие которой ведется теперь под названием DGDecode,
 и он поддерживает только MPEG-2 / VOB.</p>
<p><u>RawSource - бесформатные (сырые, raw) форматы с заголовком или без:</u></p>
<p>Внешний плагин RawSource поддерживает все виды бесформатных (raw)
 видео файлов с заголовком YUV4MPEG2 или без заголовка (видео файлы,
которые содержат YUV2, YV16, YV12, RGB или Y8 видео данные, записанные
кадр за кадром без сжатия).</p>
<p>Примеры:</p>
<pre># Следующее предполагает, что есть соответствующий YUV4MPEG2-заголовок внутри:
RawSource(&quot;d:\yuv4mpeg.yuv&quot;)

# Бесформатный файл с RGBA данными:
RawSource(&quot;d:\src6_625.raw&quot;,720,576,&quot;BGRA&quot;)

# Вы можете указать байтовую позицию видеокадров в файле прямо
# (что может быть найдено  с помощью yuvscan.exe).
# Это полезно, если это видео не сосем неформатированное,
№ но например несжатые файлы MOV или файлы с некоторым специфичным заголовком:
RawSource(&quot;d:\yuv.mov&quot;, 720, 576, &quot;UYVY&quot;, index=&quot;0:192512 1:1021952 25:21120512 50:42048512 75:62976512&quot;)</pre>

<p><u>QTSource (с QuickTime 6 или 7) и QTReader - MOV/QT:</u></p>
<p>Есть два способа загрузить ваши quicktime mov видео в AviSynth
(и еще RawSource для несжатых mov): QTSource и QTReader.
Первый появился недавно и способен открыть многие форматы quicktime
(с возможностью открыть их как YUY2), но вам необходимо установить
проигрыватель QuickTime player для возможности использовать данный плагин.
Второй (QTReader) - очень старый, не требуется установка проигрывателя
для открытия форматов quicktime в AviSynth.</p>
<p><i>QTSource:</i></p>
<p>Вам необходим Quicktime 6 для получения только видео
или Quicktime 7 для получения аудио и видео.</p>
<pre># YUY2 (по умолчанию):
QTInput(&quot;FileName.mov&quot;, color=2)

# с аудио (с QuickTime 7 возможно во многих случаях)
QTInput(&quot;FileName.mov&quot;, color=2, audio=true)

# бесформатное (raw) (с примером YUYV):
QTInput(&quot;FileName.mov&quot;, color=2, mode=1, raw=&quot;yuyv&quot;)

# dither = 1; преобразует бесформатное (raw) 10 бит в 8 бит видео (v210 = 10 бит uyvy):
QTInput(&quot;FileName.mov&quot;, color=2, dither=1, raw=&quot;v210&quot;)</pre>
<p><i>QTReader:</i></p>
<pre># Если это не работает, или вы не имеете QuickTime, скачайте плагин QTReader
(может быть найден в разделе загрузок Doom9):
LoadVFAPIPlugin(&quot;C:\QTReader\QTReader.vfp&quot;, &quot;QTReader&quot;)
QTReader(&quot;C:\quicktime.mov&quot;) </pre>

<p><u>Фильтр Import - для скриптов AviSynth:</u></p>
<p>Просто импортируйте скрипт используя <a href="../corefilters/import.htm">Import</a>
 в начале (или другом месте) вашего скрипта:</p>
<pre>Import(&quot;d:\filename.avs&quot;)</pre>
<p>В версии v2.05 или более поздних вы можете использовать автозагрузку скриптов AVSI.
Просто поместите ваш AVS-файл в каталог автозагрузки плагинов, содержащий
внешние плагины, и переименуйте расширение на 'avsi'. Смотри также
<a href="../faq.htm">FAQ</a> для обсуждения.</p>

<p><u>2) DirectShowSource:</u></p>
<p>Взгляните на раздел &quot;<a href="#cont_audio">Другие контейнеры с аудио
</a>&quot; для подробной информации.</p>

<h3><a name="load_clip_aud"></a>1.3) Загрузка аудио клипов в AviSynth</h3>
<p>Большинство аудио форматов могут быть загружены в AviSynth, но
есть некоторые исключения такие как MPL или многоканальные WMA используя W98/W2K.
Если невозможно загрузить клип в AviSynth, вы должны преобразовать их
к некоторому другому формату, который может быть загружен. При этом помните
о выборе такого формата, с которым вы получите минимальные (допустимые)
потери в качестве в результате этого преобразования.</p>
<p>Воооще есть два способа загрузить ваше аудио в AviSynth:</p>
<ol>
  <li>используя AviSynth фильтр или плагин, который предназначен
для открытия некоторого специального формата.</li>
  <li>используя фильтр DirectShowSource.</li>
</ol>
<p>Список всех этих плагинов и принимаемых ими форматов приведен ниже.</p>
<p><u>1) AviSynth фильтры и плагины, предназначенные для открытия
специфических форматов:</u></p>
<p><u>WavSource - WAV:</u></p>
<p><a href="../corefilters/wavsource.htm">WavSource</a> поддерживает все виды WAV,
такие как несжатые WAV или MP3/MP3/AC3/DTS аудио с заголовком WAVE.
WAV может быть загружен в AviSynth при условии, что вы имеете
соответствующий <font color="#FF0000">
<a href="http://en.wikipedia.org/wiki/Audio_Compression_Manager">ACM codec</a>
</font> установленным, который и используется для декодирования WAV.
Кодек по умолчанию, используемый для декодирования WAV указан в начале
медиа файла (в его заголовке; немного похоже на fourCC для видео кодеков).</p>

<p><u>audio: MP2/MP3 с заголовком WAVE:</u></p>
<p>Существует ACM кодек для MP2 называемый [<a href="http://www.geocities.com/wilbertdijkhof/qmpeg_mp2.zip">QDesign</a>].
Существует ACM кодеки для MP3 [<a href="http://www.free-codecs.com/MPEG_Layer_3_Codec_download.htm">Radium
Codec</a>] или [<a href="http://www.free-codecs.com/LAME_ACM_Codec_download.htm">Lame
ACM</a>].</p>
<p><u>audio: AC3/DTS с заголовком WAVE (также называемые DD-AC3
и DTSWAV):</u></p>
<p>Существует ACM кодек для AC3 называемый
[<a href="http://fcchandler.home.comcast.net/AC3ACM/index.html">AC3ACM</a>].
Есть ACM кодек для AC3/DTS называемый valex ACM codec
[<a href="http://sourceforge.net/project/showfiles.php?group_id=66022">vac3acm</a>].</p>
<p>
Пример:</p>
<pre># DTS в WAV:
V = BlankClip(height=576, width=720, fps=25)
A = WAVSource(&quot;D:\audio_dts.wav&quot;)
AudioDub(V, A)</pre>
<p>или если вы имеете WinDVD platinum, установите
<a href="http://forum.doom9.org/showthread.php?s=&amp;threadid=52692"> hypercube's DTSWAV filter</a>.</p>
<p><font color="#FF0000">Примеры:</font></p>
<pre><font color="#FF0000">xxx</font></pre>

<p><u>MPASource - MP1/MP2/MP3/MPA:</u></p>
<p>Пример:</p>
<pre>LoadPlugin(&quot;C:\Program Files\AviSynth25\plugins\mpasource.dll&quot;)
V = BlankClip(height=576, width=720, fps=25)
A = MPASource(&quot;D:\audio.mp3&quot;, normalize = false)
AudioDub(V, A)</pre>

<p><u>NicAudio - MP1/MP2/MP3/MPA/AC3/DTS/LPCM:</u><br>
<br>
Некоторые примеры:</p>
<pre>LoadPlugin(&quot;C:\Program Files\AviSynth25\plugins\NicAudio.dll&quot;)

# AC3 audio:
V = BlankClip(height=576, width=720, fps=25)
A = NicAC3Source(&quot;D:\audio.AC3&quot;)
#A = NicAC3Source(&quot;D:\audio.AC3&quot;, downmix=2) # downmix to stereo
AudioDub(V, A)

# LPCM audio (48 kHz, 16 bit and stereo):
V = BlankClip(height=576, width=720, fps=25)
A = NicLPCMSource(&quot;D:\audio.lpcm&quot;, 48000, 16, 2)
AudioDub(V, A)</pre>

<p><u>BassAudio - MP3/MP2/MP1/OGG/WAV/AIFF/WMA/FLAC/WavPack/Speex/Musepack/AAC/M4A/APE/CDA:</u></p>
<p>BassAudio может быть загружен
<a href="http://forum.doom9.org/showthread.php?t=108254">там</a>.
Некоторые примеры:</p>
<pre># FLAC files:
bassAudioSource(&quot;C:\ab\Dido\001 Here With Me.flc&quot;)

# OGG files:
bassAudioSource(&quot;C:\ab\Dido\001 Here With Me.ogg&quot;)

# AAC files:
bassAudioSource(&quot;C:\ab\Dido\001 Here With Me.aac&quot;)</pre>
<pre># Audio-CD копирование (Ripping) используя это плагин
# Загрузите BASSCD 2.2 с официального сайта BASS
# Извлеките basscd.dll и переименуйте его в bass_cd.dll
# Поместите bass_cd.dll в ту же папку что и bassAudio.dll
bassAudioSource(&quot;D:\Track01.cda&quot;)</pre>

<p><u>2) DirectShowSource:</u></p>
<p>Посмотрите раздел &quot;<a href="#cont_audio"> Другие контейнеры с
audio</a>&quot; для информации. Некоторые directshow фильтры (помимо имеющихся
в ffdshow) для Ogg Vorbis, Speex, Theora и FLAC могут быть найдены
<a href="http://www.illiminable.com/ogg/">там</a>.</p>

<p><u>аудио: MP2/MP3 с заголовком WAVE:</u></p>
<p>Используйте: разрешите MP1/2/3 декодирование с выбором mp3lib или libmad.</p>
<p><u>аудио: AC3/DTS с заголовком WAVE (также называемый DD-AC3
и DTSWAV):</u></p>
<p>Используйте fddshow: DTS декодирование разрешено и uncompressed: поддерживать все форматы.</p>
<p>
Примеры:</p>
<pre># DTS в WAV:
V = BlankClip(height=576, width=720, fps=25)
A = DirectShowSource(&quot;D:\audio_dts.wav&quot;)
AudioDub(V, A)</pre>
<p>или сделав graph:</p>
<pre># DTS в WAV:
# используем WAVE обработчик (parser) и ffdshow или AC3filter: [add screenshots]
V = BlankClip(height=576, width=720, fps=25)
A = DirectShowSource(&quot;D:\audio_dts_wav.grf&quot;, video=false)
AudioDub(V, A)</pre>
<p><u>aac:</u></p>
<p> Возьмите AAC directshow фильтр такой как CoreAAC (удостоверьтесь
что микширование отключено, если только вы не хотите микшировать) или ffdshow
(с AAC установленным в libfaad или realaac), и используйте</p>
<pre>DirectShowSource(&quot;d:\audio.aac&quot;)</pre>
<p>чтобы загрузить ваш AAC.</p>

<h3><a name="load_image"></a>1.4) Загрузка изображений в AviSynth</h3>
<p>1) Используйте ImageReader или ImageSource для загрузки ваших картинок
в AviSynth (может загрузить наиболее популярные форматы, за исключением
GIF и анимированных форматовs). Смотри
<a href="../corefilters/imagesource.htm">документацию</a> для информации.</p>
<p>2) Используйте Immaavs плагин для GIF, анимированных форматов и
других типов изображений.</p>
<pre># одиночная картинка:
immareadpic(&quot;x:\path\pic.bmp&quot;)

# анимированный gif:
immareadanim(&quot;x:\path\anim.gif&quot;)</pre>

<h2><a name="merit_filter"></a>2) Измененение приоритета DirectShow фильтров</h2>
<p>Запустите Radlight Filter Manager и проверьре, какой из фильтров,
способных проигрывать ваше клип, имеет более высокий приоритет (merit).
Измените приоритет фильтра, которым вы хотите проигрывать, например:</p>
<p><img border="0" src="../pictures/advancedtopics/filtermanager_ac3.jpg" width="352" height="455"></p>
<p>и выполните перезагрузку компьютера (при необходимости).
Согласно опыта, это не всегда работает. Например, в AC3Filter
есть установка называемая &quot;Filter Merit&quot; которая по умолчанию
установлена в 'Prefer AC3Filter' (Предпочитать AC3Filter).
Хотя в рассматриваемом случае приоритет AC3Filter был установлен ниже,
чем приоритет Moonlight Odio Dekoda (MERIT_NORMAL против MERIT_NORMAL+1),
первый был использован для проигрывания AC3 (предположительно
в результате этой установки 'Prefer AC3Filter' в AC3Filter; замена ее на
'Prefer other decoder' (Предпочитать другой декодер) решает проблему).
Другие фильтры могут иметь подобные установки тоже.</p>

<h2><a name="graphs"></a>3) Использование GraphEdit для создания графов
DirectShow фильтров и загрузка этих графов в AviSynth</h2>
<p>В качестве примера будет показано, как сделать граф, где CoreAAC аудио декодер
будет использован для получения аудио из AVI-AAC файла. Точнее,
будет показано, как ffdshow аудио декодер будет заменен CoreAAC аудио
декодером, где первый имел более высокий приоритет (что подразумевает,
что этот фильтр будет использован при проигрывании клипа в основанном на
DirectShow проигрывателе таком как WMP6.4 или при открытии
AVI прямо в AviSynth используя DirectShowSource):</p>
<p>Запустите GraphEdit и откройте ваш клип: File tab -&gt; Open Graph -&gt; Select All
Files -&gt; откройте ваш клип:</p>
<p><img border="0" src="../pictures/advancedtopics/directshow_avi_aac2.jpg" width="1119" height="368"></p>
<p>Щелкните правой кнопкой мыши на фильтре (ffdshow Audio decoder) -&gt; Filter Properties
-&gt; измените настройки если необходимо.</p>
<p>Graph tab -&gt; Insert Filters -&gt; в пункте DirectShow Filters -&gt; выберите
CoreAAC Audio Decoder:</p>
<p><img border="0" src="../pictures/advancedtopics/directshow_avi_aac3.jpg" width="458" height="331"></p>
<p>Нажмите Insert Filter (вставить фильтр). Удалите ffdshow аудио декодер
путем его выбора и нажатием Delete:</p>
<p><img border="0" src="../pictures/advancedtopics/directshow_avi_aac4.jpg" width="583" height="340"></p>
<p>Наконец, подсоедините CoreAAC аудио декодер, путем соединения выводов (pins)
 левой кнопкой мыши (стрелки будут нарисованы автоматически):</p>
<p><img border="0" src="../pictures/advancedtopics/directshow_avi_aac5.jpg" width="1117" height="610"></p>
<p>Проверьте и настройте свойства фильтра, если необходимо. Нажмите play
чтобы проверить, что клип может проигрываться выбранной комбинацией
DirectShow фильтров. Это очень важно, так как если он не проигрывается,
AviSynth не будет способен открыть данный клип. В этом случае вы должны
выбрать и установить другие фильтры, которые могут проиграть данный клип.</p>
<p>Наконец удалите WaveOut Device и видео фильтры, так как AviSynth
нуждается в свободном выводе (pin) для своего подсоединения
когда DirectShowSource вызывается в скрипте.</p>
<p><img border="0" src="../pictures/advancedtopics/directshow_avi_aac6.jpg" width="1119" height="325"></p>
<p>Сохраните граф как audio.grf. Если вы ходите также загрузить видео
в AviSynth, оно должно быть загружено отдельно, используя другой граф
(где аудио часть и Video Renderer удалены):</p>
<p><img border="0" src="../pictures/advancedtopics/directshow_avi.jpg" width="959" height="219"></p>
<p>Сохраните граф как video.grf. Ваш скрипт станет:</p>
<pre>vid = DirectShowSource(&quot;D:\video.grf&quot;, fps=25, convertfps=true, audio=false) # измените fps при необходимости
aud = DirectShowSource(&quot;D:\audio.grf&quot;, video=false)
AudioDub(vid, aud)</pre>
<p>
<kbd>$English Date: 2007/06/23 20:11:00 $<br>
Русский перевод 12.06.2007 Fizick</kbd></p>
</p>
</body>
</html>