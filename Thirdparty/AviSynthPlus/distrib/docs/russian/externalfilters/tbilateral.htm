<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ru">
<head>
<title>TBilateral</title>
  <meta content="text/html;charset=windows-1251" http-equiv="Content-Type">
  <link rel="stylesheet" type="text/css" href="../../avisynth.css">
<!--
Automatically generated, don't change:
$Id: tbilateral.htm,v 1.2 2006/12/13 21:01:40 fizick Exp $
-->
</head>
<body>
<h1>TBilateral</h1>
<h2>Общая информация</h2>
<b>Автор:</b>    tritical
<br><b>Версия:</b>       0.9.10<br>
<b>Загрузка:</b>   <a href="http://bengal.missouri.edu/~kes25c/">http://bengal.missouri.edu/~kes25c/</a>
<br><b>Категория:</b>   Пространственные сглаживатели
<br><b>Требования:</b>&nbsp;
<ul>
  <li>YV12 &amp; YUY2 цветовой формат</li>
</ul>

<p><b>лицензия:</b> GPL</p>

<hr size=2 width="100%" align=center>

<h2>Описание</h2>
<p>      TBilateral это пространственный сглаживающий фильтр,
который реализует алгоритм двунаправленной (bilateral) фильтрации.
Он выполняет хорошее сглаживание, в то же время сохраняя структуру изображения.
Он теперь поддерживает YV12 и YUY2 цветовые форматы
и имеет пользовательский графический интерфейс (gui)
с просмотром для помощи в настройке.
(прим. перев. - разрабатывался для мультфильмов анимэ.)</p>
<h3>Синтаксис</h3>
<p><code>TBilateral</code> (clip, int <var>&quot;diameterL&quot;</var>, int <var>&quot;diameterC&quot;</var>, float
<var>&quot;sDevL&quot;</var>, float <var>&quot;sDevC&quot;</var>, float <var>&quot;iDevL&quot;</var>, float
<var>&quot;iDevC&quot;</var>,                      float <var>&quot;csL&quot;</var>, float
<var>&quot;csC&quot;</var>, bool <var>&quot;d2&quot;</var>, bool <var>&quot;chroma&quot;</var>, bool
<var>&quot;gui&quot;</var>, PClip <var>&quot;ppClip&quot;</var>, int <var>&quot;kernS&quot;</var>, int
<var>&quot;kernI&quot;</var>, int <var>&quot;resType&quot;</var>)</p>
<h3>Параметры</h3>
<p><var>diameterL</var>/<var>diameterC</var> -  (пространственные диаметры)</p>
<p>Это устанавливает величину диаметра окна фильтрации.  Большие величины означают,
что больше пикселов будет включено в усреднение, но также являются более медленными.
Должны быть нечетными числами больше чем 1.<br>
      diameterL используется для яркости (luma), а diameterC - для цветности (chroma),
      если она обрабатывается.  Это должно быть меньше чем ширина и высота видео.</p>
<p>по умолчанию - <var>diameterL</var> = 5 (int)<br>
<var>diameterL</var> = 5 (int)</p>
<p><var>sDevL</var>/<var>sDevC</var> - (пространственные (зональные) отклонения (deviations))</p>
<p>Они устанавливают пространственные отклонения.  Чем больше sDev is,
тем меньший эффект будет иметь расстояние на взвешивание пикселов в усреднении.
То есть, если Вы увеличиваете sDev, дальние пикселы будут иметь увеличивающийся вес.
sDevL - для яркости, sDevC - для цветности.  Они должны быть больше 0.
Чтобы лучше понять эти настройки, попробуйте установить iDevL/iDevC в высокие величины, и затем
постепенно увеличивайте sDevL/sDevC от 0 вверх, сохраняя отношение iDevL/iDevC постоянным.  Увеличение
этих настроек увеличит силу сглаживания.</p>
<p>по умолчанию - <var>sDevL</var> = 1.4  (float)<br>
<var>sDevC</var> = 1.4  (float)</p>
<p><var>iDevL</var>/iDevC - (отклонения интенсивности пикселов (диапазон))</p>
<p>Они устанавливают отклонения интенсивности пикселов (или отклонения цвета в случае цветовых плоскостей).
Чем больше величина iDev, тем меньший эффект будет иметь разница пикселов во взвешивании пикселов при усреднении.
То есть, если Вы увеливаете iDev, пикселы, которые очень отличаются от текущего пиксела
будут иметь увеличивающийся вес.  iDevL - для яркости, iDevC - для цветности.  Они должны быть больше 0.
     Попробуйте увеличивать эти настройки, сохраняя отношение sDev/sDevC постоянным, чтобы получить идею,
     что они делают.  Увеличение этих настроек увеличит силу сглаживания.</p>
<p>по умолчанию - <var>iDevL</var> = 7.0  (float)<br>
<var>iDevC</var> = 7.0 (float)</p>
<p><var>csL</var>/<var>csC</var> - (весовые множители центрального пиксела)</p>
<p>Эти величины умножаются на величину пространственного веса центрального пиксела.  Величина 1 ничего не делает,
 &lt; 1 означает, что центральный пиксел будет иметь вес меньше чем нормальный, > 1 означает, что
центральный пиксел будет иметь вес больше нормального, 0 дает центральному пикселу нулевой вес.
Они должны быть не меньше 0.  Установка csL/csC в 0 даст Вам понижение шума как в SUSAN.</p>
<p>по умолчанию - <var>csL</var> = 1.0  (float)<br>
<var>csC</var> = 1.0  (float)</p>
<p><var>d2</var> - (вторая производная или первая производная)</p>
<p>Эта настройка вынуждает TBilateral использовать вторую производную вместо первой при вычислении
интенсивностей.  Использование d2 должно дать лучшие результаты на плавных градиентах или на любом том,
что подходит к кусочно-линейной модели.  Установка d2 в false даст лучшие результаты на изображениях,
которые имеют однородно окрашенные области с резкими краями (aвсе что подходит к кусочно-константной модели).
Действительная разница между этими двумя типами обычно невелика для большинства источников. Эффект довольно слабый.
</p>
<p>по умолчанию - false  (bool)</p>
<p><var>chroma</var> - (разрешить обработку цветности)</p>
<p>Если установлено равной true, то обрабатываются и плоскости цветности.  Если установлено в false,
то плоскости цветности просто копируются из источнмка в выходной кадр.</p>
<p>по умолчанию - true  (bool)</p>
<p><var>gui</var> - (графический интерфейс пользователя)</p>
<p>Если установлено в true, то этот экземпляр TBilateral стартует с графическим интерфейсом пользователя ГИП(gui).
Только один экземпляр TBilateral на скрипт может иметь графический интерфейс.  Он позволяет Вам изменять величины
diameterL/diameterC/sDevL/sDevC/iDevL/iDevC/csL/csC/d2/chroma/kernS/kernI/resType (практически все настройки).
Интерфейс также имеет превью обновляемое в реальном времени, которое позволяет Вам видеть эффект изменений,
кода вы их делаете.</p>
<p>      Графический интерфейс имеет некоторые ограничения однако. Величины diameterL/diameterC сейчас ограничены
максимум до 21 при использовании графического интерфейса.  Также, ползунок Dev имеет максимальные пределы,
связанные с тем чтобы позволить использовать ползуны для настройки.  Однако, эти максимумы
достаточно высоки, чтобы позволить даже очень сильную фильтрацию.</p>
<p>После того как Вы нашли нужные настройки, Вы можете закрыть интерфейс, нажав кнопку "OK".
Внизу закладки "advanced" есть стока, которую вы можете скопировать и вставить в Ваш скрипт avs,
чтобы продублировать текущие настройки. (ЗАМЕЧАНИЕ:  параметр ppClip не устанавливается в этой строке.)</p>
<p>по умолчанию - false (bool)</p>
<p><var>ppClip</var> - (пред-обработанный клип)</p>
<p>Указывает предварительно отфильтрованный клип, откуда TBilateral возьмет значения пикселов, когда делает
вычисления разности интенсивности.  Общая рекомендация для пред-обработки -
      Гауссов блюр (размытие) со стандартным отклонением равным используемым настройкам sDev.  Использование
предварительно отфильтрованного клипа должно помочь в удалении импульсного шума (то есть окружения с очень
большими разницами пикселов), которые стандартная двунаправленная фильтрация не затронет.  Это имеет тенденцию
иногда производить артефакты, особенно вокруг очень тонких деталей.  Другая рекомендация для пред-обработки -
это центрально-взвешенная медиана или адаптивная медиана.</p>
<p>по умолчанию - NULL (PClip)</p>
<p><var>kernS</var>/<var>kernI</var> - (пространственное ядро и ядро интенсивности)</p>
<p>Они указывают, какое ядро используется для зональных (kernS) весов и диапазонных (kernI) весов.  Возможные
выборы:</p>
<p>0 - Andrews' wave (волна Андрея)<br>
          1 - El Fallah Ford<br>
          2 - Gaussian (функция Гаусса)<br>
          3 - Huber’s mini-max (мини-макс)<br>
          4 - Lorentzian (функция Лоренца)<br>
          5 - Tukey bi-weight (двухвесовая)<br>
          6 - Linear descent (линейный спад)<br>
          7 - Cosine (косинус)<br>
          8 - Flat (плоский)<br>
          9 - Inverse (обратный)</p>
<p>Смотри следующую статью с описанием всех ядер и их свойств:</p>
<p><a href="http://dsp7.ee.uct.ac.za/~jfrancis/publicationsDir/PRASA2003.pdf">http://dsp7.ee.uct.ac.za/~jfrancis/publicationsDir/PRASA2003.pdf</a></p>
<p>Gaussian (опция 2) есть ядро, используемое в (первом предложенным) двунаправленном фильтре по умолчанию.</p>
<p>по умолчанию - 2 (<var>kernS</var>)  (int)<br>
                2 (<var>kernI</var>)</p>
<p><var>resType</var> -</p>
<p>Это указывает, как веса и величины пикселов комбинируются для получения конечного результата.
Возможные опции:</p>
<p>0 - Mean (взвешенное усреднение)<br>
          1 - Median  (взвешенная медиана)<br>
          2 - CW-Median  (взвешенная медиана + дополнительный вес центрального пиксела)</p>
<p>Опция 0 (взвешенное среднее) является типом, используемом в двунаправленном фильтре по умолчанию.</p>
<p>по умолчанию - 0  (int)</p>
<h2>Список изменений</h2>
<p>06/23/2005  v0.9.10<br>
       + некоторая оптимизация, грубо 15-20% увеличение скорости<br>
<br>
   06/21/2005  v0.9.9<br>
       + Добавил Inverse ядро (то, что называлось "Linear Descent" в v0.9.8, было, фактически, "Inverse")<br>
       - Исправил ошибку в gui программе, которая устанавливала максимумы ползунов sDevL/sDevC<br>
<br>
   06/20/2005  v0.9.8<br>
       + Добавил kernS, kernI, и resType<br>
       + Переделал gui интерфейс<br>
       - Много косметических исправлений gui (для некоторых опций не было немедленного обновления при изменении)<br>
<br>
   05/24/2005<br>
       + Добавил параметр ppClip и обработку<br>
       - Изменил некоторые величины по умолчанию<br>
       - Исправил некоторые проблемы синхро/выхода нитей с кодом gui<br>
<br>
   05/02/2005  v0.9.6<br>
       + Добавил gui с просмотром<br>
       + Убрал все ограничения yuy2 (d2)<br>
       - Исправил: настройки iDev и sDev переключались при вычислении таблиц весов (doh!)<br>
<br>
   06/16/2004  v0.9.5<br>
       - Исправил: iDevC имело i вместо f внутри списка параметров функции и  принимало только целые величины.<br>
<br>
   06/16/2004  v0.9.4<br>
       - Исправил ошибки округления с d2 = true, которые могли вести к изменению +-2 в конечных значениях пикселов<br>
       - Изменение, необходимое для этого исправления ошибки округления, также ускорило обработку d2 = true на 10-15%<br>
<br>
   06/15/2004  v0.9.3<br>
       - Добавил d2 и centerScale/centerScaleC параметры.<br>
       - Развернул y циклы, нет реального ускорения, но это сделало код огромным...<br>
<br>
   06/12/2004  v0.9.2<br>
       - Разверну x циклы в YV12 и только в яркости версии для YUY2.  Легкое ускорение.<br>
<br>
   06/11/2004  v0.9.1<br>
       - Исправил проблему с граничными пикселами на краях картинки, дающими некорректные пространственные веса.<br>
<br>
   06/11/2004  v0.9.0<br>
       - Первоначальный выпуск</p>
<p><kbd>$English Date: 2005/07/10 16:11:01 $<br>
Русский перевод 09.08.2005 Fizick http://bag.hotmail.ru</kbd>
</p>
</body>
</html>